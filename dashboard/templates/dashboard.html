{% extends "base.html" %}
{% load static %}
{% block title %}Dashboard - Tanair Manager{% endblock %}

{% block content %}
<div class="container-fluid py-4" style="background:#f5f6fa;min-height:100vh;">
  <div class="row mb-4">
    <div class="col-12 text-center">
      <h2 class="fw-bold text-primary">Dashboard</h2>
    </div>
  </div>
  <!-- Centered Navigation Cards Row -->
  <div class="row justify-content-center g-4 mb-4">
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:dashboard' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-tachometer-alt fa-2x text-primary mb-2"></i>
            <h6 class="fw-bold text-primary mb-0">Dashboard</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:analytics_dashboard' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-chart-line fa-2x text-secondary mb-2"></i>
            <h6 class="fw-bold text-secondary mb-0">Analytics</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:sensor_dashboard' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-microchip fa-2x text-success mb-2"></i>
            <h6 class="fw-bold text-success mb-0">Sensors</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:raw_sensor_data' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-broadcast-tower fa-2x text-info mb-2"></i>
            <h6 class="fw-bold text-info mb-0">Real Time Data</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:predicted_values' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-brain fa-2x text-warning mb-2"></i>
            <h6 class="fw-bold text-warning mb-0">Predictions</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:about' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-map-marked-alt fa-2x text-dark mb-2"></i>
            <h6 class="fw-bold text-dark mb-0">Map</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'habil:aqi_trend' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-wind fa-2x text-primary mb-2"></i>
            <h6 class="fw-bold text-primary mb-0">Air Quality Trend</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'dashboard:data_management' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-database fa-2x text-info mb-2"></i>
            <h6 class="fw-bold text-info mb-0">Data Management</h6>
          </div>
        </div>
      </a>
    </div>
     <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'dashboard:alerts' %}" class="w-100 text-decoration-none position-relative">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-bell fa-2x text-danger mb-2"></i>
            <h6 class="fw-bold text-danger mb-0">Alerts
              {% if alert_count and alert_count > 0 %}
                <span class="badge bg-danger ms-1">{{ alert_count }}</span>
              {% endif %}
            </h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="javascript:void(0);" onclick="openChatbotModal()" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-comments fa-2x text-primary mb-2"></i>
            <h6 class="fw-bold text-primary mb-0">Tanair Assistant</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="{% url 'dashboard:report_form' %}" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-file-alt fa-2x text-secondary mb-2"></i>
            <h6 class="fw-bold text-secondary mb-0">Reports</h6>
          </div>
        </div>
      </a>
    </div>
    <div class="col-6 col-sm-4 col-md-3 col-lg-2 d-flex">
      <a href="javascript:void(0);" onclick="toggleTheme()" class="w-100 text-decoration-none">
        <div class="card shadow-sm border-0 text-center h-100 py-3">
          <div class="card-body">
            <i class="fas fa-cog fa-2x text-dark mb-2"></i>
            <h6 class="fw-bold text-dark mb-0">Settings</h6>
          </div>
        </div>
      </a>
    </div>
  
  <!-- Metric Cards Row -->
  <div class="row mt-4">
  {% if user.is_superuser or user.is_staff %}
   
    <!-- User Management Card -->
    <div class="col-md-4 col-lg-3 mb-4">
      <div class="card shadow-sm h-100 d-flex align-items-center justify-content-center">
        <div class="card-body text-center d-flex flex-column align-items-center justify-content-center">
          <i class="fas fa-users-cog" style="font-size:2.5rem; color:#1976d2;"></i>
          <h5 class="card-title mt-2">User Management</h5>
          <a href="{% url 'dashboard:user_management' %}" class="btn btn-primary mt-2 w-100">Manage Users</a>
        </div>
      </div>
    </div>
    <!-- Add Sensor Card Button -->
    <div class="col-md-4 col-lg-3 mb-4">
      <div class="card shadow-sm h-100 d-flex align-items-center justify-content-center">
        <div class="card-body text-center d-flex flex-column align-items-center justify-content-center">
          <i class="bi bi-hdd-network-fill" style="font-size:2.5rem; color:#43a047;"></i>
          <h5 class="card-title mt-2">Sensor Management</h5>
          <a href="{% url 'dashboard:sensor_management' %}" class="btn btn-success mt-2 w-100">Add Sensor</a>
        </div>
      </div>
    </div>
  {% endif %}
  <!-- Sensor Status Cards Section -->
  {% for sensor in sensors %}
  <div class="col-md-4 col-lg-3 mb-4">
    <div class="card shadow-sm" style="background: {% if sensor.is_active %}#fbc16a{% else %}#1b8c5a{% endif %}; color: #222;">
      <div class="card-body">
        <div class="fw-bold" style="font-size:1.2rem;">{{ sensor.name|upper }}</div>
        <div><b>Location:</b> {{ sensor.location }}</div>
        <div><b>Uptime:</b> {{ sensor.uptime|default:"0" }}</div>
        <div><b>Last Active:</b> {{ sensor.last_active|default:"" }}</div>
        <div>
          <b>Battery:</b>
          <span class="badge bg-light text-dark">{{ sensor.battery_level|default:"N/A" }}%</span>
        </div>
        <div>
          <b>Signal:</b>
          <span class="badge bg-light text-dark">{{ sensor.signal_strength|default:"N/A" }}%</span>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

{% endblock %}
